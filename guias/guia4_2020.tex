\documentclass[a4paper]{article}
\usepackage[latin1]{inputenc}
%\usepackage{babel}
\topmargin 0truecm
\textheight 22truecm
\textwidth 16truecm
\oddsidemargin 0truecm
\parskip 1truemm
%\parsep 1truemm
\parindent 0em
\usepackage{amssymb}

\def\d{\,{\rm d}}

\def\RR{{\mathbb R}}
\def\CC{{\mathbb C}}
\def\NN{{\mathbb N}}
\def\ZZ{{\mathbb Z}}
\def\EE{{\mathbb E}}
\newcounter{problema}
\newcommand{\prob}[1]{\vspace{0.33cm}\stepcounter{problema}
                 \noindent{\bf Problema \arabic{problema}:}{\it #1}}

\begin{document}
\renewcommand{\labelenumi}{\bf \alph{enumi})}
\renewcommand{\labelenumii}{\alph{enumi}$_\arabic{enumii}$)}
\thispagestyle{empty}
\begin{center}
{\large {\bf M\'etodos Num\'ericos}}\\

\rule{0em}{2.em}{\bf Gu\'{i}a 4} \\ 28 de abril de 2020
\end{center}


% 1
\prob{} Para las siguientes funciones $f(x)$, y siendo $x_0 = 0$, $x_1=0.6$ y $x_2=0.9$, construya anal\'iticamente los polinomios interpolantes de Lagrange de grado 1 y 2 que aproximan la funci\'on en $x=0.45$, y encuentre el error absoluto y relativo correspondiente.
\begin{enumerate}
\item $f(x) = \ln (x+1)$
\item $f(x) = \sqrt{x+1}$
\end{enumerate}

\noindent
Grafique en un archivo postscript ambas funciones, sus polinomios interpolantes y 
la aproximaci\'on de Taylor de grado 2 (entorno a $x_o$) en el rango dado.

% 2 subrutina pl Lagrange
\prob{} Escriba una subrutina que eval\'ue el polinomio interpolante de Lagrange de orden $n$ en un punto $x$, con $x_0 < x < x_n$
, siendo $(x_i, f(x_i))$ los puntos a interpolar. La subrutina debe tener el orden del polinomio, $n$, 
un arreglo de tama\~no $n+1$ con los valores de $x_i$, un arreglo de tama\~no $n+1$ con los valores de $f(x_i)$ y
el valor de $x$ donde se evaluar\'a el polinomio, como argumentos de entrada. Finalmente, el valor del polinomio en
$x$, $P(x)$, ser\'a el \'unico argumento de salida.

Escriba un programa que utilice esta subrutina para evaluar los polinomios interpolantes de Lagrange de las funciones
del problema 1, en $N=200$ puntos equidistantes en el intervalo $[x_0,x_n]$, escribiendo los valores en un archivo. 
Grafique el polinomio y los pares $(x_i,f(x_i))$ (utilizados para interpolar), verificando el resultado. Compare adem\'as
con la expresi\'on anal\'itica (como funci\'on en {\em gnuplot}) de los polinomios.


% 3
\prob{} Se desea aproximar $\cos(x)$ en el intervalo $[0,1]$ con un error
absoluto menor a $1\times 10^{-7}$ para todo $x \in [0,1]$. Usando el teorema
del error de la interpolaci\'on polinomial, encuentre la cantidad m\'inima de
puntos de interpolaci\'on.  Verifique graficando (con {\em gnuplot}, guardando
la gr\'afica en archivo {\em postscript}) el error absoluto en el intervalo
para tres casos particulares de $\{x_i\}$.

% 4
\prob{} Construya anal\'iticamente el polinomio interpolante de Newton para las siguientes funciones. 
De una cota del error absoluto en el intervalo $[x_0,x_n]$.
\begin{enumerate}
\item $f(x) = \exp (2x) \cos(3x)$,\hspace{0.7cm} $x_0=0$, $x_1=0.3$, $x_2=0.6$, $n=2$.
\item $f(x) = \ln(x)$, \hspace{0.7cm}  $x_0=1$, $x_1=1.1$, $x_2=1.3$, $x_3=1.4$, $n=3$.
\end{enumerate}

% 4 subrutina pl Newton
\prob{} Escriba una subrutina que eval\'ue el polinomio interpolante de Newton de orden $n$ en un punto $x$, con $x_0 < x < x_n$
, siendo $(x_i, f(x_i))$ los puntos a interpolar. La subrutina debe tener el orden del polinomio, $n$, 
un arreglo de tama\~no $n+1$ con los valores de $x_i$, un arreglo de tama\~no $n+1$ con los valores de $f(x_i)$ y
el valor de $x$ donde se evaluar\'a el polinomio, como argumentos de entrada. Finalmente, el valor del polinomio en
$x$, $P(x)$, ser\'a el \'unico argumento de salida.

Escriba un programa que utilice esta subrutina para evaluar los polinomios interpolantes de Newton de las funciones
del problema 4, en $N=200$ puntos equidistantes en el intervalo $[x_0,x_n]$, escribiendo los valores en un archivo. 
Grafique el polinomio y los pares $(x_i,f(x_i))$ (utilizados para interpolar), verificando el resultado. Compare adem\'as
con la expresi\'on anal\'itica (como funci\'on en {\em gnuplot}) de los polinomios.



% 4
\prob{} 
Suponga que se conoce la función $f(x) = \frac{1}{1 + 25 x^2}$ en los puntos
$x_i = -1 + (i-1) 2 / n$ para $i=1,n+1$; que están dados en el intervalo $[-1,1]$.
Calcule la interpolación por el método de Lagrange para los valores de $n=10, 20, 40$.
Haga un gráfico en pantalla y en archivo, postscript o png en los rangos
$x=[-1:1]$ e $y=[-1,5: 1,5]$, conteniendo la función original y 
las tres interpolaciones evaluadas en 200 puntos equidistantes.
Calcule el error máximo para cada caso e incluya estos
datos de errores máximos en el gráfico.

{\bf Nota:} En este problema se observa el llamado fenómeno de Runge, en el que la interpolación
por polinomios usando puntos equiespaciados da resultados divergentes.

¿Por qué no hay contradicción con el teorema de aproximación de Weierstrass?


{\bf Hint:}
{\it   
	En el programa fortran puede grabar los errores máximos en un archivo, digamos:
	datos/maximum-err-values.lod
	
	En particular notar que el comando: maxval(abs(err10)) da el valor máximo del valor absoluto
	del arreglo err10.
	
	Luego puede preparar un archivo para hacer los gráficos con gnuplot, digamos:
	int\_lag\_runge\_10\_20\_40.lod
	
	Este archivo luego puede ser le\'ido por gnuplot con el comando:
	
	gnuplot int\_lag\_runge\_10\_20\_40.lod 
	
	Dentro del archivo int\_lag\_runge\_10\_20\_40.lod se puede leer los datos grabados
	por el programa fortran con el comando:
	
	load "datos/maximum-err-values.lod"
	
	Estos valores pueden ser incluidos en el gráfico con comandos como:
	
	set label gprintf("err10 = \%f",err10) at -0.20,-1.05
	
	set label gprintf("err20 = \%f",err20) at -0.20,-1.2
	
	set label gprintf("err40 = \%f",err40) at -0.20,-1.35
	
	
	
	}


\bigskip

\bigskip

%\newpage
\noindent {\bf Ejercicios Complementarios}



%   Evaluacion de polinomios y su derivada: Metodo de Horner 
%
\prob{} Dado el siguiente polinomio
\[
p(x) = -10 + 5 x - 12 x^2  + 6 x^3  - 2 x^4  + x^5 \ ,\]
\noindent
grafique el mismo utilizando {\em gnuplot} y observe que posee 
una \'unica ra\'iz real positiva, encuentre la misma utilizando El m\'etodo de Newton-Raphson. 
%Elija el valor inicial utilizando los teoremas que acotan la regi\'on del espacio complejo donde se encuentran las ra\'ices.
Eval\'ue el polinomio y su derivada en una subrutina utilizando el algoritmo de Horner.


\prob{ Error  de la interpolaci\'on polinomial para puntos equiespaciados:} Usando el teorema dado en el te\'orico, demuestre el siguiente

{\bf corolario}: Sea $f(x) \varepsilon C_{[a,b]}^{(n+1)}$  tal que su derivada $n+1$ es acotada en $[a,b]$: $\exists M>0 / |f^{(n+1)}(x) |< M \;\forall \,x\varepsilon [a,b]$. Definimos
$x_i=a + i \;; i=0,\cdots,n$ donde $ h=(b-a)/n$. Sea $P_n(x)$ es el polinomio interpolante a $f(x)$: $P_n(x_i)=f(x_i)\;,i=0,\cdots ,n$, entonces $\forall\;x\varepsilon [a,b]$ se tiene

\[
\left| f(x) - P_n(x)\right | \leq \frac{M}{4 (n+1)}\;\left(\frac{b-a}{n}\right)^{n+1}
\]

\end{document}
